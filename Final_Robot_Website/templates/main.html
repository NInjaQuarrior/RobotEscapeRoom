<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href='/static/sidebar.css'>
    <link rel="stylesheet" href='/static/styles.css'>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"> </script> -->
    <script src="/static/mqtt.js" type="text/javascript"></script>
</head>

<body onload=setup()>
    <!-- <body> -->
    <!-- ----------- HEADERS ----------- -->
    <title> MQP - Robot Escape Room </title>
    <!-- <h1> MQP - Robot Escape Room </h1> -->
    <div id="sqr">
		<iframe src="//192.168.1.6:8081" id="videoElement"></iframe>
        </video>
    </div>

    <!-- ----------- SIDEBAR BUTTONS ----------- -->
    <button class="sidebarButton" type="button" id="homeButton" onclick=window.location="{{ url_for('main') }}"> <img
            src="static/Images/Home.png"></button>

    <button class="sidebarButton" type="button" id="infoButton" onclick=window.location="{{ url_for('manual') }}"> <img
            src="static/Images/Info.png"></button>


    <!-- ROBOT FUNCTIONALITY -->
    <input id="camera_detect" type="checkbox" onclick="return false;"></input>
    <!-- <div id = "camera_checkmark"> &#x2713 </div> --> 
    <div id="camera_detect" style="margin-left: 25px;">Scan Code</div>
    <input id="light" type="checkbox" onclick="return false;"></input>
    <div id="light" style="margin-left: 25px;"> Light</div>
    <input id="blacklight" type="checkbox" onclick="return false;"></input>
    <div id="blacklight" style="margin-left: 25px;">Blacklight</div>

    <!-- ----------- FUNCTIONS ----------- -->
    <script>
        var client;
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function wait(sec) {
            localStorage.setItem("password_prompt", "denied");
            await sleep(sec * 1000); // sleep for 'sec' seconds 
            localStorage.setItem("password_prompt", "prompted");
        }

        function scanPassword() {
            let answer = window.prompt("Enter the Password (6 characters)");

            if (answer == "ROCKET" || answer == "rocket" || answer == "Rocket") {
                alert("Password Accepted");
                localStorage.setItem("password_prompt", "accepted");
                sleep(100);
            }
            else {
                alert("Password Denied \nWait for 5 seconds until you can scan again.");
                wait(5);
            }
        }

        function text2speech() {
            var msg = new SpeechSynthesisUtterance();
            msg.text = "Hello World";
            window.speechSynthesis.speak(msg);
        }

        function set_robot_function() {
            camera_enabled = localStorage.getItem("camera_detect");
            light_enabled = localStorage.getItem("light");
            blight_enabled = localStorage.getItem("blacklight");
            document.getElementById("camera_detect").checked = (camera_enabled == "true");
            document.getElementById("light").checked = (light_enabled == "true");
            document.getElementById("blacklight").checked = (blight_enabled == "true");
        }

        function setup() {
            set_robot_function();
        }

    </script>

</body>

</html>